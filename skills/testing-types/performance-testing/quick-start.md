# æ€§èƒ½æµ‹è¯•å¿«é€Ÿä¸Šæ‰‹æŒ‡å—

5 åˆ†é’Ÿå¿«é€ŸæŒæ¡æ€§èƒ½æµ‹è¯•æŠ€èƒ½çš„ä½¿ç”¨æ–¹æ³•ã€‚

## ğŸ“‹ å‰ç½®æ¡ä»¶

- äº†è§£åŸºæœ¬çš„ HTTP åè®®
- ç†Ÿæ‚‰å‘½ä»¤è¡Œæ“ä½œ
- äº†è§£æ€§èƒ½æµ‹è¯•åŸºæœ¬æ¦‚å¿µ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ­¥éª¤ 1ï¼šé€‰æ‹©æ€§èƒ½æµ‹è¯•å·¥å…·

æ ¹æ®ä½ çš„éœ€æ±‚é€‰æ‹©åˆé€‚çš„å·¥å…·ï¼š

| å·¥å…· | è¯­è¨€ | å­¦ä¹ æ›²çº¿ | é€‚ç”¨åœºæ™¯ |
|------|------|---------|---------|
| K6 | JavaScript | ä½ | ç°ä»£åŒ–ã€äº‘åŸç”Ÿ |
| JMeter | GUI/Java | ä¸­ | ä¼ ç»Ÿã€åŠŸèƒ½ä¸°å¯Œ |
| Gatling | Scala | ä¸­ | é«˜æ€§èƒ½ã€æŠ¥å‘Šç¾è§‚ |
| Locust | Python | ä½ | æ˜“å­¦ã€åˆ†å¸ƒå¼ |
| Artillery | YAML/JS | ä½ | é…ç½®ç®€å• |

**æ¨èæ–°æ‰‹ï¼š** K6ï¼ˆè„šæœ¬ç®€å•ã€æ–‡æ¡£å®Œå–„ï¼‰

### æ­¥éª¤ 2ï¼šå®‰è£… K6

```bash
# macOS
brew install k6

# Linux (Debian/Ubuntu)
sudo gpg -k
sudo gpg --no-default-keyring --keyring /usr/share/keyrings/k6-archive-keyring.gpg --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys C5AD17C747E3415A3642D57D77C6C491D6AC1D69
echo "deb [signed-by=/usr/share/keyrings/k6-archive-keyring.gpg] https://dl.k6.io/deb stable main" | sudo tee /etc/apt/sources.list.d/k6.list
sudo apt-get update
sudo apt-get install k6

# Windows (Chocolatey)
choco install k6

# éªŒè¯å®‰è£…
k6 version
```

### æ­¥éª¤ 3ï¼šè¿è¡Œç¬¬ä¸€ä¸ªæµ‹è¯•

åˆ›å»º `test.js`ï¼š
```javascript
import http from 'k6/http';
import { check, sleep } from 'k6';

export const options = {
  vus: 10,        // 10 ä¸ªè™šæ‹Ÿç”¨æˆ·
  duration: '30s', // æŒç»­ 30 ç§’
};

export default function () {
  const res = http.get('https://test.k6.io');
  
  check(res, {
    'çŠ¶æ€ç æ˜¯ 200': (r) => r.status === 200,
    'å“åº”æ—¶é—´ < 500ms': (r) => r.timings.duration < 500,
  });
  
  sleep(1);
}
```

è¿è¡Œæµ‹è¯•ï¼š
```bash
k6 run test.js
```

**é¢„æœŸè¾“å‡ºï¼š**
```
     âœ“ çŠ¶æ€ç æ˜¯ 200
     âœ“ å“åº”æ—¶é—´ < 500ms

     checks.........................: 100.00% âœ“ 600      âœ— 0
     data_received..................: 1.2 MB  40 kB/s
     http_req_duration..............: avg=250ms  p(95)=350ms
     http_reqs......................: 300     10/s
     vus............................: 10      min=10  max=10
```


### æ­¥éª¤ 4ï¼šè¿è¡Œç¤ºä¾‹é¡¹ç›®

æˆ‘ä»¬æä¾›äº†å®Œæ•´çš„ K6 ç¤ºä¾‹ï¼š

```bash
# 1. è¿›å…¥ç¤ºä¾‹ç›®å½•
cd skills/testing-types/performance-testing/examples/k6-load-testing

# 2. è¿è¡Œè´Ÿè½½æµ‹è¯•
./run-tests.sh load

# 3. è¿è¡Œ API æµ‹è¯•
./run-tests.sh api

# 4. æŸ¥çœ‹æŠ¥å‘Š
ls reports/
```

### æ­¥éª¤ 5ï¼šä½¿ç”¨ AI ç”Ÿæˆæµ‹è¯•è„šæœ¬

1. **æ‰“å¼€æç¤ºè¯æ–‡ä»¶**
   ```bash
   cat prompts/performance-testing.md
   ```

2. **å¤åˆ¶è™šçº¿ä»¥ä¸‹çš„å†…å®¹åˆ° AI å¯¹è¯**

3. **é™„åŠ ä½ çš„éœ€æ±‚**ï¼Œä¾‹å¦‚ï¼š
   ```
   ä¸ºä»¥ä¸‹ API ç”Ÿæˆæ€§èƒ½æµ‹è¯•è„šæœ¬ï¼š
   
   API ç«¯ç‚¹ï¼š
   - GET /api/v1/products - è·å–å•†å“åˆ—è¡¨
   - GET /api/v1/products/{id} - è·å–å•†å“è¯¦æƒ…
   - POST /api/v1/orders - åˆ›å»ºè®¢å•
   
   æ€§èƒ½è¦æ±‚ï¼š
   - æ”¯æŒ 100 å¹¶å‘ç”¨æˆ·
   - 95% è¯·æ±‚å“åº”æ—¶é—´ < 500ms
   - é”™è¯¯ç‡ < 1%
   - æŒç»­è¿è¡Œ 5 åˆ†é’Ÿ
   
   ä½¿ç”¨ K6 ç¼–å†™
   ```

4. **AI å°†ç”Ÿæˆ**ï¼š
   - å®Œæ•´çš„ K6 æµ‹è¯•è„šæœ¬
   - æ€§èƒ½é˜ˆå€¼é…ç½®
   - æµ‹è¯•åœºæ™¯è®¾è®¡
   - è¿è¡Œè¯´æ˜

## ğŸ“ æ ¸å¿ƒæ¦‚å¿µ

### 1. æµ‹è¯•ç±»å‹

#### è´Ÿè½½æµ‹è¯• (Load Test)
**ç›®çš„**: éªŒè¯ç³»ç»Ÿåœ¨é¢„æœŸè´Ÿè½½ä¸‹çš„æ€§èƒ½

```javascript
export const options = {
  stages: [
    { duration: '2m', target: 100 },  // å¢åŠ åˆ° 100 ç”¨æˆ·
    { duration: '5m', target: 100 },  // ä¿æŒ 100 ç”¨æˆ·
    { duration: '2m', target: 0 },    // é™åˆ° 0
  ],
};
```

#### å‹åŠ›æµ‹è¯• (Stress Test)
**ç›®çš„**: æ‰¾å‡ºç³»ç»Ÿçš„æ€§èƒ½æé™

```javascript
export const options = {
  stages: [
    { duration: '2m', target: 100 },
    { duration: '5m', target: 200 },
    { duration: '5m', target: 300 },
    { duration: '5m', target: 400 },  // æŒç»­å¢åŠ 
  ],
};
```

#### å°–å³°æµ‹è¯• (Spike Test)
**ç›®çš„**: æµ‹è¯•çªå‘æµé‡å¤„ç†èƒ½åŠ›

```javascript
export const options = {
  stages: [
    { duration: '1m', target: 50 },
    { duration: '30s', target: 500 },  // çªç„¶å¢åŠ 
    { duration: '1m', target: 500 },
    { duration: '30s', target: 50 },   // å¿«é€Ÿé™å›
  ],
};
```

#### æµ¸æ³¡æµ‹è¯• (Soak Test)
**ç›®çš„**: éªŒè¯é•¿æ—¶é—´è¿è¡Œçš„ç¨³å®šæ€§

```javascript
export const options = {
  stages: [
    { duration: '5m', target: 100 },
    { duration: '8h', target: 100 },  // é•¿æ—¶é—´è¿è¡Œ
    { duration: '5m', target: 0 },
  ],
};
```

### 2. æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | è¯´æ˜ | ç›®æ ‡å€¼ç¤ºä¾‹ |
|------|------|-----------|
| http_req_duration | è¯·æ±‚å“åº”æ—¶é—´ | p(95) < 500ms |
| http_req_failed | è¯·æ±‚å¤±è´¥ç‡ | < 1% |
| http_reqs | æ¯ç§’è¯·æ±‚æ•° (RPS) | > 1000 |
| vus | è™šæ‹Ÿç”¨æˆ·æ•° | 100 |
| iterations | è¿­ä»£æ¬¡æ•° | æ ¹æ®åœºæ™¯ |

### 3. ç™¾åˆ†ä½æ•° (Percentiles)

```
p(50) = 200ms  â†’ 50% çš„è¯·æ±‚ < 200msï¼ˆä¸­ä½æ•°ï¼‰
p(90) = 350ms  â†’ 90% çš„è¯·æ±‚ < 350ms
p(95) = 450ms  â†’ 95% çš„è¯·æ±‚ < 450ms
p(99) = 800ms  â†’ 99% çš„è¯·æ±‚ < 800ms
```

**ä¸ºä»€ä¹ˆä½¿ç”¨ p95 è€Œä¸æ˜¯å¹³å‡å€¼ï¼Ÿ**
- å¹³å‡å€¼ä¼šè¢«æç«¯å€¼å½±å“
- p95 æ›´èƒ½åæ˜ å¤§å¤šæ•°ç”¨æˆ·çš„ä½“éªŒ
- è¡Œä¸šæ ‡å‡†é€šå¸¸ä½¿ç”¨ p95 æˆ– p99

### 4. é˜ˆå€¼è®¾ç½®

```javascript
export const options = {
  thresholds: {
    // å“åº”æ—¶é—´
    'http_req_duration': ['p(95)<500', 'p(99)<1000'],
    
    // é”™è¯¯ç‡
    'http_req_failed': ['rate<0.01'],  // < 1%
    
    // æ£€æŸ¥é€šè¿‡ç‡
    'checks': ['rate>0.95'],  // > 95%
    
    // ç‰¹å®š API çš„é˜ˆå€¼
    'http_req_duration{api:users}': ['p(95)<300'],
  },
};
```

## ğŸ”§ å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

### K6 å‘½ä»¤

```bash
# åŸºæœ¬è¿è¡Œ
k6 run script.js

# æŒ‡å®šè™šæ‹Ÿç”¨æˆ·æ•°å’ŒæŒç»­æ—¶é—´
k6 run --vus 100 --duration 5m script.js

# ç”Ÿæˆ JSON æŠ¥å‘Š
k6 run --out json=results.json script.js

# ä½¿ç”¨ç¯å¢ƒå˜é‡
k6 run -e BASE_URL=https://example.com script.js

# è¿è¡Œç‰¹å®šåœºæ™¯
k6 run --scenario-name my_scenario script.js

# æŸ¥çœ‹ç‰ˆæœ¬
k6 version

# æŸ¥çœ‹å¸®åŠ©
k6 run --help
```

### æµ‹è¯•è„šæœ¬ç»“æ„

```javascript
import http from 'k6/http';
import { check, sleep } from 'k6';

// 1. é…ç½®é€‰é¡¹
export const options = {
  vus: 10,
  duration: '30s',
  thresholds: {
    'http_req_duration': ['p(95)<500'],
  },
};

// 2. è®¾ç½®å‡½æ•°ï¼ˆå¯é€‰ï¼‰
export function setup() {
  // æµ‹è¯•å‰æ‰§è¡Œä¸€æ¬¡
  return { data: 'test' };
}

// 3. ä¸»æµ‹è¯•å‡½æ•°
export default function (data) {
  // æ¯ä¸ªè™šæ‹Ÿç”¨æˆ·é‡å¤æ‰§è¡Œ
  const res = http.get('https://test.k6.io');
  check(res, { 'çŠ¶æ€ç æ˜¯ 200': (r) => r.status === 200 });
  sleep(1);
}

// 4. æ¸…ç†å‡½æ•°ï¼ˆå¯é€‰ï¼‰
export function teardown(data) {
  // æµ‹è¯•åæ‰§è¡Œä¸€æ¬¡
}
```

## ğŸ“Š å®æˆ˜ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šç”µå•†ç½‘ç«™æ€§èƒ½æµ‹è¯•

**éœ€æ±‚ï¼š**
```
æµ‹è¯•ç”µå•†ç½‘ç«™çš„æ€§èƒ½ï¼š
- é¦–é¡µæµè§ˆ
- å•†å“æœç´¢
- å•†å“è¯¦æƒ…
- åŠ å…¥è´­ç‰©è½¦
- ä¸‹å•

æ€§èƒ½è¦æ±‚ï¼š
- æ”¯æŒ 200 å¹¶å‘ç”¨æˆ·
- p95 å“åº”æ—¶é—´ < 1s
- é”™è¯¯ç‡ < 0.5%
```

**AI è¾“å‡ºï¼š** å®Œæ•´çš„æµ‹è¯•è„šæœ¬ + åœºæ™¯è®¾è®¡

### ç¤ºä¾‹ 2ï¼šAPI å‹åŠ›æµ‹è¯•

**éœ€æ±‚ï¼š**
```
æ‰¾å‡º REST API çš„æ€§èƒ½æé™ï¼š
- é€æ­¥å¢åŠ è´Ÿè½½
- ä» 50 åˆ° 500 ç”¨æˆ·
- æ¯ä¸ªé˜¶æ®µæŒç»­ 5 åˆ†é’Ÿ
- è®°å½•ç³»ç»Ÿå´©æºƒç‚¹
```

**AI è¾“å‡ºï¼š** å‹åŠ›æµ‹è¯•è„šæœ¬ + ç›‘æ§æŒ‡æ ‡

## ğŸ¯ æ€§èƒ½æµ‹è¯•æ£€æŸ¥æ¸…å•

### æµ‹è¯•å‰
- [ ] ç¡®å®šæµ‹è¯•ç›®æ ‡å’ŒæŒ‡æ ‡
- [ ] å‡†å¤‡æµ‹è¯•ç¯å¢ƒ
- [ ] å‡†å¤‡æµ‹è¯•æ•°æ®
- [ ] é€šçŸ¥ç›¸å…³å›¢é˜Ÿ
- [ ] å¤‡ä»½é‡è¦æ•°æ®

### æµ‹è¯•ä¸­
- [ ] ç›‘æ§ç³»ç»Ÿèµ„æº
- [ ] è®°å½•å¼‚å¸¸æƒ…å†µ
- [ ] è§‚å¯Ÿé”™è¯¯æ—¥å¿—
- [ ] æ£€æŸ¥æ•°æ®åº“æ€§èƒ½
- [ ] ç›‘æ§ç½‘ç»œçŠ¶å†µ

### æµ‹è¯•å
- [ ] åˆ†ææµ‹è¯•ç»“æœ
- [ ] ç”Ÿæˆæµ‹è¯•æŠ¥å‘Š
- [ ] è¯†åˆ«æ€§èƒ½ç“¶é¢ˆ
- [ ] æå‡ºä¼˜åŒ–å»ºè®®
- [ ] å½’æ¡£æµ‹è¯•æ•°æ®

## â“ é‡åˆ°é—®é¢˜ï¼Ÿ

1. **æŸ¥çœ‹æ•…éšœæ’é™¤ç« èŠ‚**ï¼š[SKILL.md#æ•…éšœæ’é™¤](SKILL.md#æ•…éšœæ’é™¤)
2. **æŸ¥çœ‹ç¤ºä¾‹ä»£ç **ï¼š[examples/k6-load-testing/](examples/k6-load-testing/)
3. **å‚è€ƒå®˜æ–¹æ–‡æ¡£**ï¼š
   - [K6 æ–‡æ¡£](https://k6.io/docs/)
   - [K6 ç¤ºä¾‹](https://k6.io/docs/examples/)

## ğŸ“ ä¸‹ä¸€æ­¥

- âœ… å®Œæˆå¿«é€Ÿä¸Šæ‰‹
- ğŸ“– é˜…è¯»å®Œæ•´çš„ [SKILL.md](SKILL.md)
- ğŸ”¨ è¿è¡Œç¤ºä¾‹é¡¹ç›®
- ğŸš€ ä¸ºä½ çš„é¡¹ç›®åˆ›å»ºæ€§èƒ½æµ‹è¯•
- ğŸ¤– ä½¿ç”¨ AI æç¤ºè¯ç”Ÿæˆæ›´å¤šæµ‹è¯•è„šæœ¬
- ğŸ“š å­¦ä¹ è¿›é˜¶ä¸»é¢˜ï¼ˆåˆ†å¸ƒå¼æµ‹è¯•ã€ç›‘æ§é›†æˆï¼‰

## ğŸ“š æ¨èèµ„æº

- [K6 å®˜æ–¹æ–‡æ¡£](https://k6.io/docs/)
- [æ€§èƒ½æµ‹è¯•æœ€ä½³å®è·µ](https://k6.io/docs/testing-guides/)
- [K6 ç¤ºä¾‹åº“](https://k6.io/docs/examples/)
- [æ€§èƒ½æµ‹è¯•æŒ‡å—](https://www.perfmatrix.com/)

---

**é¢„è®¡å­¦ä¹ æ—¶é—´ï¼š** 5-10 åˆ†é’Ÿ  
**éš¾åº¦çº§åˆ«ï¼š** ä¸­çº§åˆ°é«˜çº§  
**æœ€åæ›´æ–°ï¼š** 2026-02-06
